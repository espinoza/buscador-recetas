{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block style %}
{% load static %}
<link rel="stylesheet" href="{% static 'search/style.css' %}">
{% endblock %}

{% block title %}
<title>Â¡Busca tus recetas!</title>
{% endblock %}

{% block contents %}

{% include 'navbar.html' %}

<main class="container">

    <form action="{% url 'do_search' %}" method="post">
      {% csrf_token %}

      <div class="form-control">

        <div class="form-check form-switch">
          {{ form.ingredient_restriction.label }}
          {{ form.ingredient_restriction }}
        </div>
        
        <div id="include-input-area" class="tags-area container border my-2">
          <input id="include-input" class="ingredient-input shadow-none"
                 type="text" name="include_ingredient_name">
        </div>
        {{ form.include_ingredient_names }}
        
        <div id="exclude-input-area" class="tags-area container border my-2">
          <input id="exclude-input" class="ingredient-input shadow-none"
               type="text" name="exclude_ingredient_name">
        </div>
        {{ form.exclude_ingredient_names }}

      </div>

      <div class="form-control">
        {{ form.recipe_name.label }}
        {{ form.recipe_name }}
      </div>

      <input class="btn btn-success" type="submit" value="Buscar">

    </form>


  {% if recipes %}
    {% for recipe in recipes %}

      <div class="card my-4">

        <div class="card-header">
          <h5 class="card-title d-inline-block">
            <a href="{% url 'view_recipe' recipe.id %}">
              {{recipe.editions.last.title}}
            </a>
          </h5>
          <span>
            Creado por 
            <a href="{% url 'profile' recipe.author.username %}">
              {{recipe.author.get_full_name}}
            </a>
          </span>
        </div>

        <div class="card-body">
          {% for ingredient in recipe.ingredients.all %}
            <span class="badge bg-secondary">
              {{ingredient.names.first.singular}}
            </span>
          {% endfor %}
        </div>

      </div>

    {% endfor %}
  {% endif %}

  <script src="{% static 'search/ingredientTags.js' %}"></script>

</main>

{% endblock contents %}
